# ES2pd
This project provides a transformation method which helps transform Elasticsearch results to pandas' DataFrame structure.
ES的聚合结果数据格式为列表嵌字典、字典套列表，数据分析时很难从中提取到待分析的字段信息，本代码使用递归方法提取需要的字段数据。


# example
## ES数据
          {u'status': 3, u'hits': {u'hits': [], u'total': 106316, u'max_score': 0.0},
                    u'_shards': {u'successful': 282, u'failed': 0, u'total': 282}, u'timed_out': False, u'took': 479,
                    u'id': u'fac9fc08-fdc1-11e8-9515-0242ac120005', u'aggregations': {u'name': {u'buckets': [
            {u'sum_login': {u'value': 817.0}, u'time': {u'buckets': [
      {u'sum_login': {u'value': 12.0}, u'key_as_string': u'2016-07-26T00:00:00.000+08:00',
       u'key': 1469462400000, u'doc_count': 12},
      {u'sum_login': {u'value': 5.0}, u'doc_count': 5, u'predict_2': {u'value': 12.0}, u'key': 1469548800000,
       u'key_as_string': u'2016-07-27T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 14.0}, u'doc_count': 14, u'predict_2': {u'value': 12.0},
       u'key': 1469635200000, u'key_as_string': u'2016-07-28T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 79.0}, u'doc_count': 80, u'predict_2': {u'value': 12.0},
       u'key': 1469721600000, u'key_as_string': u'2016-07-29T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 12.0}, u'key': 1469808000000,
       u'key_as_string': u'2016-07-30T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 12.0}, u'key': 1469894400000,
       u'key_as_string': u'2016-07-31T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 22.0}, u'doc_count': 22, u'predict_2': {u'value': 12.0},
       u'key': 1469980800000, u'key_as_string': u'2016-08-01T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 45.0}, u'doc_count': 45, u'predict_2': {u'value': 12.0},
       u'key': 1470067200000, u'key_as_string': u'2016-08-02T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 27.0}, u'doc_count': 28, u'predict_2': {u'value': 12.0},
       u'key': 1470153600000, u'key_as_string': u'2016-08-03T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 10.0}, u'doc_count': 10, u'predict_2': {u'value': 12.0},
       u'key': 1470240000000, u'key_as_string': u'2016-08-04T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 10.0}, u'doc_count': 10, u'predict_2': {u'value': 12.0},
       u'key': 1470326400000, u'key_as_string': u'2016-08-05T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 5.0}, u'key': 1470412800000,
       u'key_as_string': u'2016-08-06T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 14.0}, u'key': 1470499200000,
       u'key_as_string': u'2016-08-07T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 79.0}, u'key': 1470585600000,
       u'key_as_string': u'2016-08-08T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 3.0}, u'doc_count': 4, u'predict_2': {u'value': 0.0}, u'key': 1470672000000,
       u'key_as_string': u'2016-08-09T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1470758400000,
       u'key_as_string': u'2016-08-10T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 22.0}, u'key': 1470844800000,
       u'key_as_string': u'2016-08-11T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 19.0}, u'doc_count': 19, u'predict_2': {u'value': 45.0},
       u'key': 1470931200000, u'key_as_string': u'2016-08-12T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 27.0}, u'key': 1471017600000,
       u'key_as_string': u'2016-08-13T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 10.0}, u'key': 1471104000000,
       u'key_as_string': u'2016-08-14T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 33.0}, u'doc_count': 33, u'predict_2': {u'value': 10.0},
       u'key': 1471190400000, u'key_as_string': u'2016-08-15T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 26.0}, u'doc_count': 26, u'predict_2': {u'value': 0.0}, u'key': 1471276800000,
       u'key_as_string': u'2016-08-16T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 31.0}, u'doc_count': 31, u'predict_2': {u'value': 0.0}, u'key': 1471363200000,
       u'key_as_string': u'2016-08-17T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1471449600000,
       u'key_as_string': u'2016-08-18T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 3.0}, u'key': 1471536000000,
       u'key_as_string': u'2016-08-19T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1471622400000,
       u'key_as_string': u'2016-08-20T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1471708800000,
       u'key_as_string': u'2016-08-21T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 36.0}, u'doc_count': 38, u'predict_2': {u'value': 19.0},
       u'key': 1471795200000, u'key_as_string': u'2016-08-22T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 26.0}, u'doc_count': 26, u'predict_2': {u'value': 0.0}, u'key': 1471881600000,
       u'key_as_string': u'2016-08-23T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 30.0}, u'doc_count': 30, u'predict_2': {u'value': 0.0}, u'key': 1471968000000,
       u'key_as_string': u'2016-08-24T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 28.0}, u'doc_count': 28, u'predict_2': {u'value': 33.0},
       u'key': 1472054400000, u'key_as_string': u'2016-08-25T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 11.0}, u'doc_count': 11, u'predict_2': {u'value': 26.0},
       u'key': 1472140800000, u'key_as_string': u'2016-08-26T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 31.0}, u'key': 1472227200000,
       u'key_as_string': u'2016-08-27T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1472313600000,
       u'key_as_string': u'2016-08-28T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 13.0}, u'doc_count': 13, u'predict_2': {u'value': 0.0}, u'key': 1472400000000,
       u'key_as_string': u'2016-08-29T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 18.0}, u'doc_count': 18, u'predict_2': {u'value': 0.0}, u'key': 1472486400000,
       u'key_as_string': u'2016-08-30T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 20.0}, u'doc_count': 20, u'predict_2': {u'value': 0.0}, u'key': 1472572800000,
       u'key_as_string': u'2016-08-31T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 36.0}, u'key': 1472659200000,
       u'key_as_string': u'2016-09-01T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 3.0}, u'doc_count': 3, u'predict_2': {u'value': 26.0}, u'key': 1472745600000,
       u'key_as_string': u'2016-09-02T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 30.0}, u'key': 1472832000000,
       u'key_as_string': u'2016-09-03T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 28.0}, u'key': 1472918400000,
       u'key_as_string': u'2016-09-04T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 9.0}, u'doc_count': 12, u'predict_2': {u'value': 11.0}, u'key': 1473004800000,
       u'key_as_string': u'2016-09-05T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 8.0}, u'doc_count': 8, u'predict_2': {u'value': 0.0}, u'key': 1473091200000,
       u'key_as_string': u'2016-09-06T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 4.0}, u'doc_count': 4, u'predict_2': {u'value': 0.0}, u'key': 1473177600000,
       u'key_as_string': u'2016-09-07T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 26.0}, u'doc_count': 27, u'predict_2': {u'value': 13.0},
       u'key': 1473264000000, u'key_as_string': u'2016-09-08T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 38.0}, u'doc_count': 39, u'predict_2': {u'value': 18.0},
       u'key': 1473350400000, u'key_as_string': u'2016-09-09T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 62.0}, u'doc_count': 62, u'predict_2': {u'value': 20.0},
       u'key': 1473436800000, u'key_as_string': u'2016-09-10T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1473523200000,
       u'key_as_string': u'2016-09-11T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 16.0}, u'doc_count': 17, u'predict_2': {u'value': 3.0}, u'key': 1473609600000,
       u'key_as_string': u'2016-09-12T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 35.0}, u'doc_count': 36, u'predict_2': {u'value': 0.0}, u'key': 1473696000000,
       u'key_as_string': u'2016-09-13T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1473782400000,
       u'key_as_string': u'2016-09-14T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 9.0}, u'key': 1473868800000,
       u'key_as_string': u'2016-09-15T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 8.0}, u'key': 1473955200000,
       u'key_as_string': u'2016-09-16T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 4.0}, u'key': 1474041600000,
       u'key_as_string': u'2016-09-17T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 26.0}, u'key': 1474128000000,
       u'key_as_string': u'2016-09-18T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 38.0}, u'key': 1474214400000,
       u'key_as_string': u'2016-09-19T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 28.0}, u'doc_count': 29, u'predict_2': {u'value': 62.0},
       u'key': 1474300800000, u'key_as_string': u'2016-09-20T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 39.0}, u'doc_count': 42, u'predict_2': {u'value': 0.0}, u'key': 1474387200000,
       u'key_as_string': u'2016-09-21T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 24.0}, u'doc_count': 24, u'predict_2': {u'value': 16.0},
       u'key': 1474473600000, u'key_as_string': u'2016-09-22T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 7.0}, u'doc_count': 11, u'predict_2': {u'value': 35.0}, u'key': 1474560000000,
       u'key_as_string': u'2016-09-23T00:00:00.000+08:00'},
      {u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1474646400000,
       u'key_as_string': u'2016-09-24T00:00:00.000+08:00'},
      {u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1474732800000,
       u'key_as_string': u'2016-09-25T00:00:00.000+08:00'}]}, u'key': u'张三',
   u'doc_count': 837},
  {u'sum_login': {u'value': 817.0}, u'time': {u'buckets': [
      {u'sum_login': {u'value': 12.0}, u'key_as_string': u'2016-07-26T00:00:00.000+08:00',
       u'key': 1469462400000, u'doc_count': 12},
      {u'sum_login': {u'value': 5.0}, u'doc_count': 5, u'predict_2': {u'value': 12.0}, u'key': 1469548800000,
       u'key_as_string': u'2016-07-27T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 14.0}, u'doc_count': 14, u'predict_2': {u'value': 12.0},
       u'key': 1469635200000, u'key_as_string': u'2016-07-28T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 79.0}, u'doc_count': 80, u'predict_2': {u'value': 12.0},
       u'key': 1469721600000, u'key_as_string': u'2016-07-29T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 12.0}, u'key': 1469808000000,
       u'key_as_string': u'2016-07-30T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 12.0}, u'key': 1469894400000,
       u'key_as_string': u'2016-07-31T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 22.0}, u'doc_count': 22, u'predict_2': {u'value': 12.0},
       u'key': 1469980800000, u'key_as_string': u'2016-08-01T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 45.0}, u'doc_count': 45, u'predict_2': {u'value': 12.0},
       u'key': 1470067200000, u'key_as_string': u'2016-08-02T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 27.0}, u'doc_count': 28, u'predict_2': {u'value': 12.0},
       u'key': 1470153600000, u'key_as_string': u'2016-08-03T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 10.0}, u'doc_count': 10, u'predict_2': {u'value': 12.0},
       u'key': 1470240000000, u'key_as_string': u'2016-08-04T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 10.0}, u'doc_count': 10, u'predict_2': {u'value': 12.0},
       u'key': 1470326400000, u'key_as_string': u'2016-08-05T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 5.0}, u'key': 1470412800000,
       u'key_as_string': u'2016-08-06T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 14.0}, u'key': 1470499200000,
       u'key_as_string': u'2016-08-07T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 79.0}, u'key': 1470585600000,
       u'key_as_string': u'2016-08-08T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 3.0}, u'doc_count': 4, u'predict_2': {u'value': 0.0}, u'key': 1470672000000,
       u'key_as_string': u'2016-08-09T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1470758400000,
       u'key_as_string': u'2016-08-10T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 22.0}, u'key': 1470844800000,
       u'key_as_string': u'2016-08-11T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 19.0}, u'doc_count': 19, u'predict_2': {u'value': 45.0},
       u'key': 1470931200000, u'key_as_string': u'2016-08-12T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 27.0}, u'key': 1471017600000,
       u'key_as_string': u'2016-08-13T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 10.0}, u'key': 1471104000000,
       u'key_as_string': u'2016-08-14T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 33.0}, u'doc_count': 33, u'predict_2': {u'value': 10.0},
       u'key': 1471190400000, u'key_as_string': u'2016-08-15T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 26.0}, u'doc_count': 26, u'predict_2': {u'value': 0.0}, u'key': 1471276800000,
       u'key_as_string': u'2016-08-16T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 31.0}, u'doc_count': 31, u'predict_2': {u'value': 0.0}, u'key': 1471363200000,
       u'key_as_string': u'2016-08-17T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1471449600000,
       u'key_as_string': u'2016-08-18T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 3.0}, u'key': 1471536000000,
       u'key_as_string': u'2016-08-19T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1471622400000,
       u'key_as_string': u'2016-08-20T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1471708800000,
       u'key_as_string': u'2016-08-21T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 36.0}, u'doc_count': 38, u'predict_2': {u'value': 19.0},
       u'key': 1471795200000, u'key_as_string': u'2016-08-22T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 26.0}, u'doc_count': 26, u'predict_2': {u'value': 0.0}, u'key': 1471881600000,
       u'key_as_string': u'2016-08-23T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 30.0}, u'doc_count': 30, u'predict_2': {u'value': 0.0}, u'key': 1471968000000,
       u'key_as_string': u'2016-08-24T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 28.0}, u'doc_count': 28, u'predict_2': {u'value': 33.0},
       u'key': 1472054400000, u'key_as_string': u'2016-08-25T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 11.0}, u'doc_count': 11, u'predict_2': {u'value': 26.0},
       u'key': 1472140800000, u'key_as_string': u'2016-08-26T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 31.0}, u'key': 1472227200000,
       u'key_as_string': u'2016-08-27T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1472313600000,
       u'key_as_string': u'2016-08-28T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 13.0}, u'doc_count': 13, u'predict_2': {u'value': 0.0}, u'key': 1472400000000,
       u'key_as_string': u'2016-08-29T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 18.0}, u'doc_count': 18, u'predict_2': {u'value': 0.0}, u'key': 1472486400000,
       u'key_as_string': u'2016-08-30T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 20.0}, u'doc_count': 20, u'predict_2': {u'value': 0.0}, u'key': 1472572800000,
       u'key_as_string': u'2016-08-31T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 36.0}, u'key': 1472659200000,
       u'key_as_string': u'2016-09-01T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 3.0}, u'doc_count': 3, u'predict_2': {u'value': 26.0}, u'key': 1472745600000,
       u'key_as_string': u'2016-09-02T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 30.0}, u'key': 1472832000000,
       u'key_as_string': u'2016-09-03T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 28.0}, u'key': 1472918400000,
       u'key_as_string': u'2016-09-04T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 9.0}, u'doc_count': 12, u'predict_2': {u'value': 11.0}, u'key': 1473004800000,
       u'key_as_string': u'2016-09-05T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 8.0}, u'doc_count': 8, u'predict_2': {u'value': 0.0}, u'key': 1473091200000,
       u'key_as_string': u'2016-09-06T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 4.0}, u'doc_count': 4, u'predict_2': {u'value': 0.0}, u'key': 1473177600000,
       u'key_as_string': u'2016-09-07T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 26.0}, u'doc_count': 27, u'predict_2': {u'value': 13.0},
       u'key': 1473264000000, u'key_as_string': u'2016-09-08T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 38.0}, u'doc_count': 39, u'predict_2': {u'value': 18.0},
       u'key': 1473350400000, u'key_as_string': u'2016-09-09T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 62.0}, u'doc_count': 62, u'predict_2': {u'value': 20.0},
       u'key': 1473436800000, u'key_as_string': u'2016-09-10T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1473523200000,
       u'key_as_string': u'2016-09-11T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 16.0}, u'doc_count': 17, u'predict_2': {u'value': 3.0}, u'key': 1473609600000,
       u'key_as_string': u'2016-09-12T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 35.0}, u'doc_count': 36, u'predict_2': {u'value': 0.0}, u'key': 1473696000000,
       u'key_as_string': u'2016-09-13T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1473782400000,
       u'key_as_string': u'2016-09-14T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 9.0}, u'key': 1473868800000,
       u'key_as_string': u'2016-09-15T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 8.0}, u'key': 1473955200000,
       u'key_as_string': u'2016-09-16T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 4.0}, u'key': 1474041600000,
       u'key_as_string': u'2016-09-17T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 26.0}, u'key': 1474128000000,
       u'key_as_string': u'2016-09-18T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 0.0}, u'doc_count': 0, u'predict_2': {u'value': 38.0}, u'key': 1474214400000,
       u'key_as_string': u'2016-09-19T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 28.0}, u'doc_count': 29, u'predict_2': {u'value': 62.0},
       u'key': 1474300800000, u'key_as_string': u'2016-09-20T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 39.0}, u'doc_count': 42, u'predict_2': {u'value': 0.0}, u'key': 1474387200000,
       u'key_as_string': u'2016-09-21T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 24.0}, u'doc_count': 24, u'predict_2': {u'value': 16.0},
       u'key': 1474473600000, u'key_as_string': u'2016-09-22T00:00:00.000+08:00'},
      {u'sum_login': {u'value': 7.0}, u'doc_count': 11, u'predict_2': {u'value': 35.0}, u'key': 1474560000000,
       u'key_as_string': u'2016-09-23T00:00:00.000+08:00'},
      {u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1474646400000,
       u'key_as_string': u'2016-09-24T00:00:00.000+08:00'},
      {u'doc_count': 0, u'predict_2': {u'value': 0.0}, u'key': 1474732800000,
       u'key_as_string': u'2016-09-25T00:00:00.000+08:00'}]}, u'key': u'李四',
       u'doc_count': 837}, ], u'doc_count_error_upper_bound': -1,
       u'sum_other_doc_count': 97917}}}

## es2pd函数参数

    data：ES的分桶聚合结果，字典格式
    nested：嵌套分桶聚合名称，对于上面的例子，就是name、time，列表形式输入
    dest_list：需要提取的目标字段，如sum_login、predict_2 


## 结果数据 

         name                 time  sum_login  predict_2  
    0    张三  2016-07-26 00:00:00       12.0        NaN  
    1    张三  2016-07-27 00:00:00        5.0       12.0  
    2    张三  2016-07-28 00:00:00       14.0       12.0  
    3    张三  2016-07-29 00:00:00       79.0       12.0  
    4    张三  2016-07-30 00:00:00        0.0       12.0  
    ..    ..                  ...        ...        ...  
    119  李四  2016-09-21 00:00:00       39.0        0.0  
    120  李四  2016-09-22 00:00:00       24.0       16.0  
    121  李四  2016-09-23 00:00:00        7.0       35.0  
    122  李四  2016-09-24 00:00:00        NaN        0.0  
    123  李四  2016-09-25 00:00:00        NaN        0.0  

    [124 rows x 4 columns]
